{"ast":null,"code":"import _slicedToArray from\"/home/runner/work/inference/inference/xinference/web/ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{CssBaseline,ThemeProvider}from'@mui/material';import Snackbar from'@mui/material/Snackbar';import React,{useEffect,useState}from'react';import{useCookies}from'react-cookie';import{HashRouter}from'react-router-dom';import{Alert}from'./components/alertComponent';import{ApiContextProvider}from'./components/apiContext';import AuthAlertDialog from'./components/authAlertDialog';import{getEndpoint}from'./components/utils';import WraperRoutes from'./router/index';import{useMode}from'./theme';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useMode=useMode(),_useMode2=_slicedToArray(_useMode,1),theme=_useMode2[0];var _useCookies=useCookies(['token']),_useCookies2=_slicedToArray(_useCookies,3),cookie=_useCookies2[0],setCookie=_useCookies2[1],removeCookie=_useCookies2[2];var _useState=useState(''),_useState2=_slicedToArray(_useState,2),msg=_useState2[0],setMsg=_useState2[1];var endPoint=getEndpoint();useEffect(function(){// token possible value: no_auth / need_auth / <real bearer token>\nfetch(endPoint+'/v1/cluster/auth',{method:'GET',headers:{'Content-Type':'application/json'}}).then(function(res){if(!res.ok){res.json().then(function(errorData){setMsg(\"Server error: \".concat(res.status,\" - \").concat(errorData.detail||'Unknown error'));});}else{res.json().then(function(data){if(!data.auth&&cookie.token!=='no_auth'){setCookie('token','no_auth',{path:'/'});}else if(data.auth&&!sessionStorage.getItem('token')){removeCookie('token',{path:'/'});}else if(!data.auth&&sessionStorage.getItem('token')){sessionStorage.removeItem('token');}});}});},[]);var handleClose=function handleClose(event,reason){if(reason==='clickaway'){return;}setMsg('');};return/*#__PURE__*/_jsxs(\"div\",{className:\"app\",children:[/*#__PURE__*/_jsx(Snackbar,{open:msg!=='',autoHideDuration:10000,anchorOrigin:{vertical:'top',horizontal:'center'},onClose:handleClose,children:/*#__PURE__*/_jsx(Alert,{severity:\"error\",onClose:handleClose,sx:{width:'100%'},children:msg})}),/*#__PURE__*/_jsx(HashRouter,{children:/*#__PURE__*/_jsx(ThemeProvider,{theme:theme,children:/*#__PURE__*/_jsxs(ApiContextProvider,{children:[/*#__PURE__*/_jsx(CssBaseline,{}),/*#__PURE__*/_jsx(AuthAlertDialog,{}),/*#__PURE__*/_jsx(WraperRoutes,{})]})})})]});}export default App;","map":{"version":3,"names":["CssBaseline","ThemeProvider","Snackbar","React","useEffect","useState","useCookies","HashRouter","Alert","ApiContextProvider","AuthAlertDialog","getEndpoint","WraperRoutes","useMode","jsx","_jsx","jsxs","_jsxs","App","_useMode","_useMode2","_slicedToArray","theme","_useCookies","_useCookies2","cookie","setCookie","removeCookie","_useState","_useState2","msg","setMsg","endPoint","fetch","method","headers","then","res","ok","json","errorData","concat","status","detail","data","auth","token","path","sessionStorage","getItem","removeItem","handleClose","event","reason","className","children","open","autoHideDuration","anchorOrigin","vertical","horizontal","onClose","severity","sx","width"],"sources":["/home/runner/work/inference/inference/xinference/web/ui/src/App.js"],"sourcesContent":["import { CssBaseline, ThemeProvider } from '@mui/material'\nimport Snackbar from '@mui/material/Snackbar'\nimport React, { useEffect, useState } from 'react'\nimport { useCookies } from 'react-cookie'\nimport { HashRouter } from 'react-router-dom'\n\nimport { Alert } from './components/alertComponent'\nimport { ApiContextProvider } from './components/apiContext'\nimport AuthAlertDialog from './components/authAlertDialog'\nimport { getEndpoint } from './components/utils'\nimport WraperRoutes from './router/index'\nimport { useMode } from './theme'\n\nfunction App() {\n  const [theme] = useMode()\n  const [cookie, setCookie, removeCookie] = useCookies(['token'])\n  const [msg, setMsg] = useState('')\n\n  const endPoint = getEndpoint()\n\n  useEffect(() => {\n    // token possible value: no_auth / need_auth / <real bearer token>\n    fetch(endPoint + '/v1/cluster/auth', {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    }).then((res) => {\n      if (!res.ok) {\n        res.json().then((errorData) => {\n          setMsg(\n            `Server error: ${res.status} - ${\n              errorData.detail || 'Unknown error'\n            }`\n          )\n        })\n      } else {\n        res.json().then((data) => {\n          if (!data.auth && cookie.token !== 'no_auth') {\n            setCookie('token', 'no_auth', { path: '/' })\n          } else if (data.auth && !sessionStorage.getItem('token')) {\n            removeCookie('token', { path: '/' })\n          } else if (!data.auth && sessionStorage.getItem('token')) {\n            sessionStorage.removeItem('token')\n          }\n        })\n      }\n    })\n  }, [])\n\n  const handleClose = (event, reason) => {\n    if (reason === 'clickaway') {\n      return\n    }\n    setMsg('')\n  }\n\n  return (\n    <div className=\"app\">\n      <Snackbar\n        open={msg !== ''}\n        autoHideDuration={10000}\n        anchorOrigin={{ vertical: 'top', horizontal: 'center' }}\n        onClose={handleClose}\n      >\n        <Alert severity=\"error\" onClose={handleClose} sx={{ width: '100%' }}>\n          {msg}\n        </Alert>\n      </Snackbar>\n      <HashRouter>\n        <ThemeProvider theme={theme}>\n          <ApiContextProvider>\n            <CssBaseline />\n            <AuthAlertDialog />\n            <WraperRoutes />\n          </ApiContextProvider>\n        </ThemeProvider>\n      </HashRouter>\n    </div>\n  )\n}\n\nexport default App\n"],"mappings":"6IAAA,OAASA,WAAW,CAAEC,aAAa,KAAQ,eAAe,CAC1D,MAAO,CAAAC,QAAQ,KAAM,wBAAwB,CAC7C,MAAO,CAAAC,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,UAAU,KAAQ,cAAc,CACzC,OAASC,UAAU,KAAQ,kBAAkB,CAE7C,OAASC,KAAK,KAAQ,6BAA6B,CACnD,OAASC,kBAAkB,KAAQ,yBAAyB,CAC5D,MAAO,CAAAC,eAAe,KAAM,8BAA8B,CAC1D,OAASC,WAAW,KAAQ,oBAAoB,CAChD,MAAO,CAAAC,YAAY,KAAM,gBAAgB,CACzC,OAASC,OAAO,KAAQ,SAAS,QAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAEjC,QAAS,CAAAC,GAAGA,CAAA,CAAG,CACb,IAAAC,QAAA,CAAgBN,OAAO,CAAC,CAAC,CAAAO,SAAA,CAAAC,cAAA,CAAAF,QAAA,IAAlBG,KAAK,CAAAF,SAAA,IACZ,IAAAG,WAAA,CAA0CjB,UAAU,CAAC,CAAC,OAAO,CAAC,CAAC,CAAAkB,YAAA,CAAAH,cAAA,CAAAE,WAAA,IAAxDE,MAAM,CAAAD,YAAA,IAAEE,SAAS,CAAAF,YAAA,IAAEG,YAAY,CAAAH,YAAA,IACtC,IAAAI,SAAA,CAAsBvB,QAAQ,CAAC,EAAE,CAAC,CAAAwB,UAAA,CAAAR,cAAA,CAAAO,SAAA,IAA3BE,GAAG,CAAAD,UAAA,IAAEE,MAAM,CAAAF,UAAA,IAElB,GAAM,CAAAG,QAAQ,CAAGrB,WAAW,CAAC,CAAC,CAE9BP,SAAS,CAAC,UAAM,CACd;AACA6B,KAAK,CAACD,QAAQ,CAAG,kBAAkB,CAAE,CACnCE,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,CAACC,IAAI,CAAC,SAACC,GAAG,CAAK,CACf,GAAI,CAACA,GAAG,CAACC,EAAE,CAAE,CACXD,GAAG,CAACE,IAAI,CAAC,CAAC,CAACH,IAAI,CAAC,SAACI,SAAS,CAAK,CAC7BT,MAAM,kBAAAU,MAAA,CACaJ,GAAG,CAACK,MAAM,QAAAD,MAAA,CACzBD,SAAS,CAACG,MAAM,EAAI,eAAe,CAEvC,CAAC,CACH,CAAC,CAAC,CACJ,CAAC,IAAM,CACLN,GAAG,CAACE,IAAI,CAAC,CAAC,CAACH,IAAI,CAAC,SAACQ,IAAI,CAAK,CACxB,GAAI,CAACA,IAAI,CAACC,IAAI,EAAIpB,MAAM,CAACqB,KAAK,GAAK,SAAS,CAAE,CAC5CpB,SAAS,CAAC,OAAO,CAAE,SAAS,CAAE,CAAEqB,IAAI,CAAE,GAAI,CAAC,CAAC,CAC9C,CAAC,IAAM,IAAIH,IAAI,CAACC,IAAI,EAAI,CAACG,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC,CAAE,CACxDtB,YAAY,CAAC,OAAO,CAAE,CAAEoB,IAAI,CAAE,GAAI,CAAC,CAAC,CACtC,CAAC,IAAM,IAAI,CAACH,IAAI,CAACC,IAAI,EAAIG,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC,CAAE,CACxDD,cAAc,CAACE,UAAU,CAAC,OAAO,CAAC,CACpC,CACF,CAAC,CAAC,CACJ,CACF,CAAC,CAAC,CACJ,CAAC,CAAE,EAAE,CAAC,CAEN,GAAM,CAAAC,WAAW,CAAG,QAAd,CAAAA,WAAWA,CAAIC,KAAK,CAAEC,MAAM,CAAK,CACrC,GAAIA,MAAM,GAAK,WAAW,CAAE,CAC1B,OACF,CACAtB,MAAM,CAAC,EAAE,CAAC,CACZ,CAAC,CAED,mBACEd,KAAA,QAAKqC,SAAS,CAAC,KAAK,CAAAC,QAAA,eAClBxC,IAAA,CAACb,QAAQ,EACPsD,IAAI,CAAE1B,GAAG,GAAK,EAAG,CACjB2B,gBAAgB,CAAE,KAAM,CACxBC,YAAY,CAAE,CAAEC,QAAQ,CAAE,KAAK,CAAEC,UAAU,CAAE,QAAS,CAAE,CACxDC,OAAO,CAAEV,WAAY,CAAAI,QAAA,cAErBxC,IAAA,CAACP,KAAK,EAACsD,QAAQ,CAAC,OAAO,CAACD,OAAO,CAAEV,WAAY,CAACY,EAAE,CAAE,CAAEC,KAAK,CAAE,MAAO,CAAE,CAAAT,QAAA,CACjEzB,GAAG,CACC,CAAC,CACA,CAAC,cACXf,IAAA,CAACR,UAAU,EAAAgD,QAAA,cACTxC,IAAA,CAACd,aAAa,EAACqB,KAAK,CAAEA,KAAM,CAAAiC,QAAA,cAC1BtC,KAAA,CAACR,kBAAkB,EAAA8C,QAAA,eACjBxC,IAAA,CAACf,WAAW,GAAE,CAAC,cACfe,IAAA,CAACL,eAAe,GAAE,CAAC,cACnBK,IAAA,CAACH,YAAY,GAAE,CAAC,EACE,CAAC,CACR,CAAC,CACN,CAAC,EACV,CAAC,CAEV,CAEA,cAAe,CAAAM,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}