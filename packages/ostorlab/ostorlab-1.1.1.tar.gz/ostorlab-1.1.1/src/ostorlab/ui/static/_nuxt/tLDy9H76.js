import{Y as v,c as T,_ as L}from"./C0HrfPqI.js";import{d as $,r as d,a as O,o as j,j as P,H,t as f,N as W,A as r,x as c,z as o,v as w,B as g,y as V,$ as x,a0 as Y,U as C,a1 as z,C as K,D as R}from"./aGegSQSD.js";import{u as q}from"./DYZsiYsl.js";import{u as J,V as Q,b as X,a as Z}from"./FuJjgQGx.js";import{_ as ee,V as ae}from"./C9rQ_aW9.js";import{A as te}from"./PpeMCrAR.js";import{V as oe,a as ne}from"./BxgNqSx_.js";import{_ as le}from"./DlAUqK2U.js";const se=T(L),re=u=>(K("data-v-f74cb3db"),u=u(),R(),u),ue={class:"pb-5"},ie={key:0,class:"mb-0"},de={key:1,class:"mb-0"},ce=re(()=>c("span",{class:"headline"},"Create New Scanner",-1)),pe={class:"mb-4"},me="yaml",ve=$({__name:"AgentGroupForm",props:{agentGroup:{type:Object,default:()=>({id:"",key:"",name:"",description:"",agents:{agents:[]}})},isEditMode:{type:Boolean,default:!1},scanner:{type:Object,default:()=>({endpoint:"",name:"",apiKey:""})}},emits:["close-form"],setup(u,{emit:F}){const y={id:"",key:"",name:"",description:"",agents:{agents:[]}},n=u,N=d(),S=F,_=J(),l=d(y),i=d(""),h={theme:"vs",wordWrap:"on",wordWrapColumn:"on",fontFamily:"Fira Code",automaticLayout:!0,minimap:{enabled:!1},Placeholder:!0,PlaceholderText:"Start typing here"},{$axios:k}=O(),b=new te(k),s=d(null),G=d([]),p=d(!1);j(()=>{n.agentGroup!==null&&n.agentGroup!==void 0&&n.agentGroup.yamlSource!==null&&n.agentGroup.yamlSource!==void 0&&(i.value=n.agentGroup.yamlSource),n.scanner!==null&&n.scanner!==void 0&&(s.value=n.scanner)});const m=P(()=>s.value!=null&&i.value.trim()!==""),U=t=>{const e=v.stringify(v.parse(t));if(e!=null)return e},E=async()=>{if(m.value==!0&&l.value!==null)try{const t=U(i.value);if(s.value!==null&&t!==null&&t!==void 0){const e=v.parse(t);n.isEditMode==!0&&await b.deleteAgentGroup(s.value,parseInt(l.value.id)),await b.createAgentGroup({scanner:s.value,agentGroup:{description:l.value.description||"",agents:e==null?void 0:e.agents,name:l.value.name}})}A(),S("close-form"),_.reportSuccess("Agent group saved successfully.")}catch(t){_.reportError((t==null?void 0:t.message)||"Failed to save Agent group information. Please try again.")}},A=()=>{l.value=y,i.value="",s.value=null},I=()=>{A(),S("close-form")},B=t=>{const e=(t.name||"").trim()!=="";return{title:e?t.name:t.endpoint,subtitle:e?t.endpoint:""}};H(()=>n.agentGroup,t=>{l.value={...t}},{immediate:!0,deep:!0});const D=q();return G.value=D.scanners||[],(t,e)=>{const M=se;return f(),W(ae,{ref_key:"form",ref:N,modelValue:m.value,"onUpdate:modelValue":e[7]||(e[7]=a=>m.value=a),onSubmit:z(E,["prevent"])},{default:r(()=>[c("div",ue,[o(oe,{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=a=>s.value=a),items:G.value,"item-props":B,"hide-details":"",variant:"outlined","item-title":"endpoint",density:"compact",clearable:"","return-object":"",disabled:u.isEditMode,label:"Select a scanner",placeholder:"Select or create a scanner for the agent group"},{selection:r(({item:a})=>[(a.raw.name||"").trim()!==""?(f(),w("p",ie,[g(V(a.raw.name)+" (",1),c("code",null,V(a.raw.endpoint),1),g(") ")])):(f(),w("code",de,V(a.raw.endpoint),1))]),"no-data":r(()=>[c("p",{class:"create-scanner mb-0 pl-4 py-0",onClick:e[0]||(e[0]=a=>p.value=!0)}," Create New Scanner ")]),_:1},8,["modelValue","items","disabled"]),o(ne,{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=a=>p.value=a),persistent:"","max-width":"600px"},{default:r(()=>[o(Q,null,{default:r(()=>[o(X,null,{default:r(()=>[ce]),_:1}),o(Z,null,{default:r(()=>[o(ee,{onCloseForm:e[2]||(e[2]=a=>p.value=!1)})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),o(x,{modelValue:l.value.name,"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.name=a),variant:"outlined",density:"compact",label:"Agent Group Name",placeholder:"Agent Group Name"},null,8,["modelValue"]),o(x,{modelValue:l.value.description,"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.description=a),variant:"outlined",density:"compact",label:"Agent Group Description",placeholder:"Agent Group Description"},null,8,["modelValue"]),c("div",pe,[o(Y,null,{default:r(()=>[g(" Agent Group Definition ")]),_:1}),o(M,{modelValue:i.value,"onUpdate:modelValue":e[6]||(e[6]=a=>i.value=a),lang:me,options:h,style:{"min-height":"300px"}},null,8,["modelValue"])]),o(C,{class:"me-2",type:"submit",color:"success",text:"Save","prepend-icon":"mdi-check",disabled:!m.value},null,8,["disabled"]),o(C,{text:"Cancel","prepend-icon":"mdi-close",onClick:I})]),_:1},8,["modelValue"])}}}),Ae=le(ve,[["__scopeId","data-v-f74cb3db"]]);export{Ae as A};
