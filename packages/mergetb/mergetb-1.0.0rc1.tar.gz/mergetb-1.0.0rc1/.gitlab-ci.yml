stages:
  - package

pypackage:
  stage: package
  image: registry.gitlab.com/mergetb/devops/builder/f40-cib
  before_script:
    - dnf -y install python3-pip
    - pip3 install --upgrade setuptools wheel twine
  script:
    - VERSION="${CI_COMMIT_TAG}" python3 setup.py sdist bdist_wheel
    - python3 -m twine upload dist/* -u __token__ -p "${TWINE_API_TOKEN_MERGE}"
  only:
    - tags
