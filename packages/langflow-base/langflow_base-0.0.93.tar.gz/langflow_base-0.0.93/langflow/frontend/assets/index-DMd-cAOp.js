import{a9 as h,r as a,A as H,u as J,z as W,aq as Z,x as ee,b5 as k,b6 as te,b7 as se,b8 as ae,b9 as le,j as e,ba as re,bb as oe,i as ne,c as ie,I as _,t as K,a$ as de,ar as ce}from"./index-DugHs1zq.js";import{I as ue,C as pe,S as w}from"./index-BtJhXLEn.js";import{P as me}from"./index-BgUGMBxR.js";import{S as xe}from"./index-JVT3rcxt.js";import{u as he,T as ge}from"./index-C0-Y76wX.js";import{P as be}from"./index-va40B6Wq.js";import{S as O,a as L,b as z,c as V,d as fe,e as u}from"./select-y7Zfqo9c.js";import"./index-DEyF4mDW.js";import"./index-r4VfA4EI.js";import"./index-BTKZZIZD.js";import"./index-BNRQjE7R.js";import"./input-BBLODMOP.js";import"./addNewVariableButton-DOFKcKz2.js";import"./popover-BoT3hib3.js";import"./index-DBvHSJua.js";import"./label-BZZvrSGa.js";import"./index-Fwx-o5rU.js";import"./separator-zNeG_xON.js";import"./checkbox-Cp8Gj5nb.js";import"./index-CsuEKUZG.js";import"./index-DX26fhId.js";import"./shortcuts-BAVRR9Ck.js";import"./index-CQJAwG_T.js";import"./index-CKHl3ayo.js";function Me(){const c=h(t=>t.hasApiKey),l=h(t=>t.validApiKey),p=h(t=>t.loadingApiKey),g=h(t=>t.updateValidApiKey),{apiKey:B}=a.useContext(H),b=J(t=>t.setErrorData),D=W(t=>t.currentFlowId),[s,m]=a.useState(!0),{id:x}=Z(),[i,q]=a.useState([]),[f,M]=a.useState(""),[o,C]=a.useState([]),[j,N]=a.useState(0),[S,A]=a.useState(12),[v,E]=a.useState(1),[T,G]=a.useState("Popular"),[n,y]=a.useState("All"),[Y,P]=a.useState(""),[d,R]=a.useState("all"),{isFetching:$,data:Q}=he(),U=ee();a.useEffect(()=>{p||(c?l||b({title:k,list:[se]}):(b({title:k,list:[te]}),m(!1)))},[p,l,c,D]),a.useEffect(()=>{X()},[n,T,v,S,i,d,l,c,B,Y,p,x]);function X(){p||(m(!0),ae({component_id:x,page:v,limit:S,is_component:n==="All"?null:n!=="Flows",sort:T==="Popular"?"-count(downloads)":"name",tags:i,liked:d==="likedbyme"&&l?!0:null,isPrivate:null,search:f===""?null:f,filterByUser:d==="createdbyme"&&l?!0:null}).then(t=>{var r;!(t!=null&&t.authorized)&&l===!0?(g(!1),R("all")):(t!=null&&t.authorized&&g(!0),m(!1),C((t==null?void 0:t.results)??[]),N((i==null?void 0:i.length)===0?Number((t==null?void 0:t.count)??0):((r=t==null?void 0:t.results)==null?void 0:r.length)??0))}).catch(t=>{var r,F;((r=t.response)==null?void 0:r.status)===403||((F=t.response)==null?void 0:F.status)===401?g(!1):(C([]),N(0),m(!1),b({title:le,list:[t.response.data.detail]}))}))}function I(){E(1),A(12)}return e.jsx(me,{betaIcon:!0,title:re,description:oe,button:e.jsxs(ne,{"data-testid":"api-key-button-store",disabled:s,className:ie(`${l?"":"animate-pulse border-error"}`,s?"cursor-not-allowed":""),variant:"primary",onClick:()=>{U("/settings/general/api")},children:[e.jsx(_,{name:"Key",className:"mr-2 w-4"}),"API Key"]}),children:e.jsxs("div",{className:"flex h-full w-full flex-col justify-between",children:[e.jsxs("div",{className:"flex w-full flex-col gap-4 p-0",children:[e.jsxs("div",{className:"flex items-end gap-4",children:[e.jsx(ue,{loading:s,divClasses:"relative h-12 w-[40%]",value:f,onChange:t=>M(t.target.value),onKeyDown:t=>{t.key==="Enter"&&P(K.uniqueId())},onClick:()=>{P(K.uniqueId())}}),e.jsxs("div",{className:"ml-4 flex w-full gap-2 border-b border-border",children:[e.jsx("button",{"data-testid":"all-button-store",disabled:s,onClick:()=>{y("All")},className:(n==="All"?"border-b-2 border-primary p-3":"border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(s?" cursor-not-allowed":""),children:"All"}),e.jsx("button",{"data-testid":"flows-button-store",disabled:s,onClick:()=>{I(),y("Flows")},className:(n==="Flows"?"border-b-2 border-primary p-3":"border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(s?" cursor-not-allowed":""),children:"Flows"}),e.jsx("button",{"data-testid":"components-button-store",disabled:s,onClick:()=>{I(),y("Components")},className:(n==="Components"?"border-b-2 border-primary p-3":"border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(s?" cursor-not-allowed":""),children:"Components"}),e.jsx(xe,{content:"Coming Soon",children:e.jsx("button",{className:"cursor-not-allowed p-3 text-muted-foreground",children:"Bundles"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(O,{disabled:s,onValueChange:R,value:d,children:[e.jsx(L,{className:"mr-4 w-[160px] flex-shrink-0",children:e.jsx(z,{placeholder:"Filter Values"})}),e.jsx(V,{children:e.jsxs(fe,{children:[e.jsx(u,{value:"all",children:"All"}),e.jsx(u,{disabled:!c||!l,value:"createdbyme",children:"Created By Me"}),e.jsx(u,{disabled:!c||!l,value:"likedbyme",children:"Liked By Me"})]})})]}),x===void 0?e.jsx(ge,{tags:Q??[],loadingTags:$,disabled:s,selectedTags:i,setSelectedTags:q}):e.jsxs(de,{variant:"outline",size:"sq",className:"gap-2 bg-beta-foreground text-background hover:bg-beta-foreground",children:[e.jsx(ce,{to:"/store",className:"cursor-pointer",children:e.jsx(_,{name:"X",className:"h-4 w-4"})}),x]},"id")]}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsx("span",{className:"px-0.5 text-sm text-muted-foreground",children:(!s||o.length!==0)&&e.jsxs(e.Fragment,{children:[j," ",j!==1?"results":"result"]})}),e.jsxs(O,{disabled:s,onValueChange:t=>{G(t)},children:[e.jsx(L,{"data-testid":"select-order-store",children:e.jsx(z,{placeholder:"Popular"})}),e.jsxs(V,{children:[e.jsx(u,{value:"Popular",children:"Popular"}),e.jsx(u,{value:"Alphabetical",children:"Alphabetical"})]})]})]}),e.jsx("div",{className:"grid w-full gap-4 md:grid-cols-2 lg:grid-cols-3",children:!s||o.length!==0?o.map(t=>{var r;return e.jsx(e.Fragment,{children:e.jsx(pe,{data:t,authorized:l,disabled:s,playground:((r=t.last_tested_version)==null?void 0:r.includes("1.0.0"))&&!t.is_component},t.id)})}):e.jsxs(e.Fragment,{children:[e.jsx(w,{}),e.jsx(w,{}),e.jsx(w,{})]})}),!s&&(o==null?void 0:o.length)===0&&e.jsx("div",{className:"mt-6 flex w-full items-center justify-center text-center",children:e.jsx("div",{className:"flex h-full w-full flex-col",children:e.jsx("div",{className:"flex w-full flex-col gap-4",children:e.jsx("div",{className:"grid w-full gap-4",children:d!="all"?e.jsxs(e.Fragment,{children:["You haven't"," ",d==="createdbyme"?"created":"liked"," ","anything with the selected filters yet."]}):e.jsxs(e.Fragment,{children:["There are no"," ",n=="Flows"?"Flows":"Components"," with the selected filters."]})})})})})]}),!s&&o.length>0&&e.jsx("div",{className:"relative py-6",children:e.jsx(be,{storeComponent:!0,pageIndex:v,pageSize:S,totalRowsCount:j,paginate:(t,r)=>{E(r),A(t)}})})]})})}export{Me as default};
