import{bf as j,R as C,bl as M,j as m,bc as O,r as u,bg as $,cb as J,bi as G,bj as w,bh as Q}from"./index-DugHs1zq.js";function W(e){const t=e+"CollectionProvider",[c,o]=j(t),[v,I]=c(t,{collectionRef:{current:null},itemMap:new Map}),g=f=>{const{scope:n,children:i}=f,d=C.useRef(null),r=C.useRef(new Map).current;return m.jsx(v,{scope:n,itemMap:r,collectionRef:d,children:i})};g.displayName=t;const E=e+"CollectionSlot",p=C.forwardRef((f,n)=>{const{scope:i,children:d}=f,r=I(E,i),s=M(n,r.collectionRef);return m.jsx(O,{ref:s,children:d})});p.displayName=E;const a=e+"CollectionItemSlot",F="data-radix-collection-item",x=C.forwardRef((f,n)=>{const{scope:i,children:d,...r}=f,s=C.useRef(null),S=M(n,s),T=I(a,i);return C.useEffect(()=>(T.itemMap.set(s,{ref:s,...r}),()=>void T.itemMap.delete(s))),m.jsx(O,{[F]:"",ref:S,children:d})});x.displayName=a;function b(f){const n=I(e+"CollectionConsumer",f);return C.useCallback(()=>{const d=n.collectionRef.current;if(!d)return[];const r=Array.from(d.querySelectorAll(`[${F}]`));return Array.from(n.itemMap.values()).sort((T,y)=>r.indexOf(T.ref.current)-r.indexOf(y.ref.current))},[n.collectionRef,n.itemMap])}return[{Provider:g,Slot:p,ItemSlot:x},b,o]}var X=u.createContext(void 0);function Z(e){const t=u.useContext(X);return e||t||"ltr"}var _="rovingFocusGroup.onEntryFocus",ee={bubbles:!1,cancelable:!0},A="RovingFocusGroup",[N,L,te]=W(A),[oe,de]=j(A,[te]),[ne,re]=oe(A),k=u.forwardRef((e,t)=>m.jsx(N.Provider,{scope:e.__scopeRovingFocusGroup,children:m.jsx(N.Slot,{scope:e.__scopeRovingFocusGroup,children:m.jsx(ce,{...e,ref:t})})}));k.displayName=A;var ce=u.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:c,orientation:o,loop:v=!1,dir:I,currentTabStopId:g,defaultCurrentTabStopId:E,onCurrentTabStopIdChange:p,onEntryFocus:a,preventScrollOnEntryFocus:F=!1,...x}=e,b=u.useRef(null),f=M(t,b),n=Z(I),[i=null,d]=$({prop:g,defaultProp:E,onChange:p}),[r,s]=u.useState(!1),S=J(a),T=L(c),y=u.useRef(!1),[V,P]=u.useState(0);return u.useEffect(()=>{const l=b.current;if(l)return l.addEventListener(_,S),()=>l.removeEventListener(_,S)},[S]),m.jsx(ne,{scope:c,orientation:o,dir:n,loop:v,currentTabStopId:i,onItemFocus:u.useCallback(l=>d(l),[d]),onItemShiftTab:u.useCallback(()=>s(!0),[]),onFocusableItemAdd:u.useCallback(()=>P(l=>l+1),[]),onFocusableItemRemove:u.useCallback(()=>P(l=>l-1),[]),children:m.jsx(G.div,{tabIndex:r||V===0?-1:0,"data-orientation":o,...x,ref:f,style:{outline:"none",...e.style},onMouseDown:w(e.onMouseDown,()=>{y.current=!0}),onFocus:w(e.onFocus,l=>{const Y=!y.current;if(l.target===l.currentTarget&&Y&&!r){const D=new CustomEvent(_,ee);if(l.currentTarget.dispatchEvent(D),!D.defaultPrevented){const h=T().filter(R=>R.focusable),H=h.find(R=>R.active),q=h.find(R=>R.id===i),z=[H,q,...h].filter(Boolean).map(R=>R.ref.current);B(z,F)}}y.current=!1}),onBlur:w(e.onBlur,()=>s(!1))})})}),K="RovingFocusGroupItem",U=u.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:c,focusable:o=!0,active:v=!1,tabStopId:I,...g}=e,E=Q(),p=I||E,a=re(K,c),F=a.currentTabStopId===p,x=L(c),{onFocusableItemAdd:b,onFocusableItemRemove:f}=a;return u.useEffect(()=>{if(o)return b(),()=>f()},[o,b,f]),m.jsx(N.ItemSlot,{scope:c,id:p,focusable:o,active:v,children:m.jsx(G.span,{tabIndex:F?0:-1,"data-orientation":a.orientation,...g,ref:t,onMouseDown:w(e.onMouseDown,n=>{o?a.onItemFocus(p):n.preventDefault()}),onFocus:w(e.onFocus,()=>a.onItemFocus(p)),onKeyDown:w(e.onKeyDown,n=>{if(n.key==="Tab"&&n.shiftKey){a.onItemShiftTab();return}if(n.target!==n.currentTarget)return;const i=ie(n,a.orientation,a.dir);if(i!==void 0){if(n.metaKey||n.ctrlKey||n.altKey||n.shiftKey)return;n.preventDefault();let r=x().filter(s=>s.focusable).map(s=>s.ref.current);if(i==="last")r.reverse();else if(i==="prev"||i==="next"){i==="prev"&&r.reverse();const s=r.indexOf(n.currentTarget);r=a.loop?ae(r,s+1):r.slice(s+1)}setTimeout(()=>B(r))}})})})});U.displayName=K;var se={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ue(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function ie(e,t,c){const o=ue(e.key,c);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(o))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(o)))return se[o]}function B(e,t=!1){const c=document.activeElement;for(const o of e)if(o===c||(o.focus({preventScroll:t}),document.activeElement!==c))return}function ae(e,t){return e.map((c,o)=>e[(t+o)%e.length])}var me=k,pe=U;async function ve(e){let t=!1;return new Promise(c=>{const o=document.createElement("input");o.type="file",o.accept=(e==null?void 0:e.accept)??".json",o.multiple=(e==null?void 0:e.multiple)??!0,o.style.display="none",o.onchange=async v=>{t=!0,c(Array.from(v.target.files)),document.body.removeChild(o)},window.addEventListener("focus",()=>{setTimeout(()=>{t||(c([]),document.body.removeChild(o))},300)},{once:!0}),document.body.appendChild(o),o.click()})}function Ie(e){const t=u.useRef({value:e,previous:e});return u.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}export{pe as I,me as R,W as a,de as b,ve as c,Ie as d,Z as u};
