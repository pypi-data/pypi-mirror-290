(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8538],{73846:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dataset/new",function(){return n(95327)}])},43124:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(24246),s=n(17749),i=n(88038),a=n.n(i),o=n(86677);n(27378);var l=n(11596),c=n(72247),d=n(11032),u=()=>{let e=(0,o.useRouter)();return(0,r.jsx)(s.xuv,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,r.jsxs)(s.xuv,{children:[(0,r.jsxs)(s.Kqy,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,r.jsx)(s.xvT,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,r.jsx)(s.zxk,{size:"sm",variant:"outline",onClick:()=>{e.push(d.fz)},children:"Configure"})]}),(0,r.jsxs)(s.xvT,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},f=e=>{let{children:t,title:n,padded:i=!0,mainProps:d}=e,f=(0,l.hz)(),h=(0,o.useRouter)(),x="/privacy-requests"===h.pathname||"/datastore-connection"===h.pathname,m=!(f.flags.privacyRequestsConfiguration&&x),{data:g}=(0,c.JE)(void 0,{skip:m}),{data:p}=(0,c.PW)(void 0,{skip:m}),v=f.flags.privacyRequestsConfiguration&&(!g||!p)&&x;return(0,r.jsxs)(s.kCb,{"data-testid":n,direction:"column",h:"100vh",children:[(0,r.jsxs)(a(),{children:[(0,r.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,r.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsxs)(s.kCb,{as:"main",direction:"column",py:i?6:0,px:i?10:0,h:i?"calc(100% - 48px)":"full",flex:1,minWidth:0,overflow:"auto",...d,children:[v?(0,r.jsx)(u,{}):null,t]})]})}},60136:function(e,t,n){"use strict";n.d(t,{D4:function(){return i.D4},MM:function(){return f},Ot:function(){return c},c6:function(){return s},cj:function(){return x},e$:function(){return o},fn:function(){return l},iC:function(){return h},nU:function(){return u},tB:function(){return d}});var r,s,i=n(41164);let a="An unexpected error occurred. Please try again.",o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;if((0,i.Bw)(e)){if((0,i.hE)(e.data))return e.data.detail;if((0,i.cz)(e.data)){var n;let t=null===(n=e.data.detail)||void 0===n?void 0:n[0];return"".concat(null==t?void 0:t.msg,": ").concat(null==t?void 0:t.loc)}if(409===e.status&&(0,i.Dy)(e.data)||404===e.status&&(0,i.XD)(e.data))return"".concat(e.data.detail.error," (").concat(e.data.detail.fides_key,")")}return t};function l(e){return"object"==typeof e&&null!=e&&"status"in e}function c(e){return"object"==typeof e&&null!=e&&"data"in e&&"string"==typeof e.data.detail}function d(e){return"object"==typeof e&&null!=e&&"data"in e&&Array.isArray(e.data.detail)}let u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{status:500,message:a};if((0,i.oK)(e))return{status:e.originalStatus,message:e.data};if((0,i.Bw)(e)){let{status:n}=e;return{status:n,message:o(e,t.message)}}return t},f=e=>Object.entries(e).map(e=>({value:e[1],label:e[1]}));(r=s||(s={})).GVL="gvl",r.AC="gacp",r.COMPASS="compass";let h={gvl:{label:"GVL",fullName:"Global Vendor List"},gacp:{label:"AC",fullName:"Google Additional Consent List"},compass:{label:"",fullName:""}},x=e=>{let t=e.split(".")[0];return"gacp"===t?"gacp":"gvl"===t?"gvl":"compass"}},65399:function(e,t,n){"use strict";n.d(t,{HK:function(){return i},VY:function(){return r.V},O3:function(){return o}});var r=n(75139),s=n(60136);let i=()=>{let{errorAlert:e}=(0,r.V)();return{handleError:t=>{let n="An unexpected error occurred. Please try again.";(0,s.Ot)(t)?n=t.data.detail:(0,s.tB)(t)&&(n=t.data.detail[0].msg),e(n)}}};var a=n(27378);let o=e=>{let t=(0,a.useRef)(void 0);return(0,a.useEffect)(()=>{let n=n=>{var r;(null===(r=t.current)||void 0===r?void 0:r.contains(n.target))||e()};return document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}},[t,e]),{ref:t}}},75139:function(e,t,n){"use strict";n.d(t,{V:function(){return i}});var r=n(24246),s=n(17749);let i=()=>{let e=(0,s.pmc)();return{errorAlert:(t,n,i)=>{let a={...i,position:(null==i?void 0:i.position)||"top",render:e=>{let{onClose:i}=e;return(0,r.jsxs)(s.bZj,{alignItems:"normal",status:"error",children:[(0,r.jsx)(s.zMQ,{}),(0,r.jsxs)(s.xuv,{children:[n&&(0,r.jsx)(s.CdC,{children:n}),(0,r.jsx)(s.XaZ,{children:t})]}),(0,r.jsx)(s.PZ7,{onClick:i,position:"relative",right:0,size:"sm",top:-1})]})}};(null==i?void 0:i.id)&&e.isActive(i.id)?e.update(i.id,a):e(a)},successAlert:(t,n,i)=>{let a={...i,position:(null==i?void 0:i.position)||"top",render:e=>{let{onClose:i}=e;return(0,r.jsxs)(s.bZj,{alignItems:"normal",status:"success",variant:"subtle",children:[(0,r.jsx)(s.zMQ,{}),(0,r.jsxs)(s.xuv,{children:[n&&(0,r.jsx)(s.CdC,{children:n}),(0,r.jsx)(s.XaZ,{children:t})]}),(0,r.jsx)(s.PZ7,{onClick:i,position:"relative",right:0,size:"sm",top:-1})]})}};(null==i?void 0:i.id)&&e.isActive(i.id)?e.update(i.id,a):e(a)}}}},77650:function(e,t,n){"use strict";var r=n(24246),s=n(17749);t.Z=e=>{let{isOpen:t,onClose:n,onConfirm:i,onCancel:a,title:o,message:l,cancelButtonText:c,cancelButtonThemingProps:d,continueButtonText:u,continueButtonThemingProps:f,isLoading:h,returnFocusOnClose:x,isCentered:m,testId:g="confirmation-modal",icon:p}=e;return(0,r.jsxs)(s.u_l,{isOpen:t,onClose:n,size:"lg",returnFocusOnClose:null==x||x,isCentered:m,children:[(0,r.jsx)(s.ZAr,{}),(0,r.jsxs)(s.hzk,{textAlign:"center",p:6,"data-testid":g,children:[p?(0,r.jsx)(s.M5Y,{mb:2,children:p}):null,o?(0,r.jsx)(s.xBx,{fontWeight:"medium",pb:0,children:o}):null,l?(0,r.jsx)(s.fef,{children:l}):null,(0,r.jsx)(s.mzw,{children:(0,r.jsxs)(s.MIq,{columns:2,width:"100%",children:[(0,r.jsx)(s.zxk,{variant:"outline",mr:3,onClick:()=>{a&&a(),n()},"data-testid":"cancel-btn",isDisabled:h,...d,children:c||"Cancel"}),(0,r.jsx)(s.zxk,{colorScheme:"primary",onClick:i,"data-testid":"continue-btn",isLoading:h,...f,children:u||"Continue"})]})})]})]})}},73485:function(e,t,n){"use strict";n.d(t,{R:function(){return o}});var r=n(24246),s=n(17749),i=n(79894),a=n.n(i);let o=e=>{let{onClick:t,...n}=e;return(0,r.jsxs)(s.kCb,{alignItems:"center",mt:-4,mb:3,onClick:t,cursor:"pointer",...n,children:[(0,r.jsx)(s.hU,{"aria-label":"Back",icon:(0,r.jsx)(s.Rpv,{}),mr:2,size:"xs",variant:"outline"}),(0,r.jsx)(s.xvT,{as:"a",fontSize:"sm",fontWeight:"500",children:"Back"})]})};t.Z=e=>{let{backPath:t,...n}=e;return(0,r.jsxs)(s.kCb,{alignItems:"center",mb:6,...n,children:[(0,r.jsx)(s.hU,{as:a(),href:t,"aria-label":"Back",icon:(0,r.jsx)(s.Rpv,{}),mr:2,size:"xs",variant:"outline"}),(0,r.jsx)(s.xvT,{as:a(),href:t,fontSize:"sm",fontWeight:"500",children:"Back"})]})}},16781:function(e,t,n){"use strict";n.d(t,{MA:function(){return o},Vo:function(){return c},t5:function(){return l}});var r=n(24246),s=n(17749);let i=e=>{let{children:t}=e;return(0,r.jsxs)(s.xvT,{"data-testid":"toast-success-msg",children:[(0,r.jsx)("strong",{children:"Success:"})," ",t]})},a=e=>{let{children:t}=e;return(0,r.jsxs)(s.xvT,{"data-testid":"toast-error-msg",children:[(0,r.jsx)("strong",{children:"Error:"})," ",t]})},o={variant:"subtle",position:"top",description:"",duration:5e3,status:"success",isClosable:!0},l=e=>{let t=(0,r.jsx)(i,{children:e});return{...o,description:t}},c=e=>{let t=(0,r.jsx)(a,{children:e});return{...o,description:t,status:"error"}}},50558:function(e,t,n){"use strict";var r=n(24246),s=n(17749);n(27378),t.Z=e=>{let{isEmptyState:t,yamlError:n}=e;return(0,r.jsx)(s.Rg9,{in:!0,children:(0,r.jsxs)(s.xuv,{w:"fit-content",bg:"white",p:3,borderRadius:3,children:[(0,r.jsxs)(s.Ugi,{children:[(0,r.jsx)(s.X6q,{as:"h5",color:"gray.700",size:"xs",children:"YAML"}),(0,r.jsx)(s.Vp9,{colorScheme:"red",size:"sm",variant:"solid",children:"Error"})]}),(0,r.jsx)(s.xuv,{bg:"red.50",border:"1px solid",borderColor:"red.300",color:"red.300",mt:"16px",borderRadius:"6px",children:(0,r.jsxs)(s.Ugi,{alignItems:"flex-start",margin:["14px","17px","14px","17px"],children:[(0,r.jsx)(s.f9v,{}),t&&(0,r.jsxs)(s.xuv,{children:[(0,r.jsx)(s.X6q,{as:"h5",color:"red.500",fontWeight:"semibold",size:"xs",children:"Error message:"}),(0,r.jsx)(s.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:"Yaml system is required"})]}),n&&(0,r.jsxs)(s.xuv,{children:[(0,r.jsx)(s.X6q,{as:"h5",color:"red.500",fontWeight:"semibold",size:"xs",children:"Error message:"}),(0,r.jsx)(s.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:n.message}),(0,r.jsx)(s.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:n.reason}),(0,r.jsxs)(s.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:["Ln ",(0,r.jsx)("b",{children:n.mark.line}),", Col"," ",(0,r.jsx)("b",{children:n.mark.column}),", Pos"," ",(0,r.jsx)("b",{children:n.mark.position})]})]})]})})]})})}},12719:function(e,t,n){"use strict";n.d(t,{F:function(){return a},M:function(){return i}});var r=n(76649),s=n(65218);let i=n.n(s)()(()=>n.e(7088).then(n.bind(n,57088)).then(e=>e.default),{loadableGenerated:{webpack:()=>[57088]},ssr:!1}),a=e=>(0,r.Ln)({name:"string"},e)&&"YAMLException"===e.name},95327:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return E}});var r=n(24246),s=n(17749),i=n(27378),a=n(11596),o=n(43124),l=n(73485),c=n(11032),d=n(39514),u=n(34090),f=n(86677),h=n(45007),x=n(16310),m=n(34803),g=n(60136),p=n(77650),v=n(16781),j=n(36701),y=n(96878),b=n(51394),C=n(435);let k=e=>!("system_type"in e),z={url:"",classify:!1,classifyConfirmed:!1},w=x.Ry().shape({url:x.Z_().required().label("Database URL"),classify:x.O7(),classifyConfirmed:x.O7().when(["url","classify"],{is:(e,t)=>e&&t,then:()=>x.O7().equals([!0])})});var _=()=>{let[e,{isLoading:t}]=(0,C.pR)(),[n,{isLoading:i}]=(0,C.IR)(),[o,{isLoading:l}]=(0,y.Du)(),c=t||i||l,d=(0,s.pmc)(),x=(0,f.useRouter)(),_=(0,a.hz)(),A=(0,h.I0)(),S=async t=>{var n;let r=await e({organization_key:j.Av,generate:{config:{connection_string:t.url},target:b.GC.DB,type:b.j.DATASETS}});if("error"in r)return{error:(0,g.e$)(r.error)};let s=(null!==(n=r.data.generate_results)&&void 0!==n?n:[]).filter(k);return s&&s.length>0?{datasets:s}:{error:"Unable to generate a dataset with this connection."}},L=async e=>{let t=await n(e);return"error"in t?{error:(0,g.e$)(t.error)}:{dataset:t.data}},R=async e=>{let{values:t,datasets:n}=e,r=await o({dataset_schemas:n.map(e=>{let{name:t,fides_key:n}=e;return{fides_key:n,name:t}}),schema_config:{organization_key:j.Av,generate:{config:{connection_string:t.url},target:b.GC.DB,type:b.j.DATASETS}}});return"error"in r?{error:(0,g.e$)(r.error)}:{classifyInstances:r.data.classify_instances}},D=async e=>{var t;let n=await S(e);if("error"in n){d((0,v.Vo)(n.error));return}let r=await Promise.all(n.datasets.map(e=>L(e))),s=null!==(t=r.find(e=>"error"in e))&&void 0!==t?t:r[0];if("error"in s){d((0,v.Vo)(s.error));return}if(!e.classify){d((0,v.t5)("Generated ".concat(s.dataset.name," dataset"))),x.push("/dataset/".concat(s.dataset.fides_key));return}let i=await R({values:e,datasets:n.datasets});if("error"in i){d((0,v.Vo)(i.error));return}d((0,v.t5)("Generate and classify are now in progress")),A((0,C.Zl)(s.dataset.fides_key)),x.push("/dataset")};return(0,r.jsx)(u.J9,{initialValues:{...z,classify:_.plus},validationSchema:w,onSubmit:D,validateOnChange:!1,validateOnBlur:!1,children:e=>{let{isSubmitting:t,errors:n,values:i,submitForm:a,resetForm:o,setFieldValue:l}=e;return(0,r.jsxs)(u.l0,{children:[(0,r.jsxs)(s.gCW,{spacing:8,align:"left",children:[(0,r.jsx)(s.xvT,{size:"sm",color:"gray.700",children:"Connect to a database using the connection URL. You may have received this URL from a colleague or your Ethyca developer support engineer."}),(0,r.jsx)(s.xuv,{children:(0,r.jsx)(m.j0,{name:"url",label:"Database URL"})}),_.plus?(0,r.jsx)(m.w8,{name:"classify",label:"Classify dataset",tooltip:"Use Fides Classify to suggest labels based on your data."}):null,(0,r.jsx)(s.xuv,{children:(0,r.jsx)(s.zxk,{size:"sm",colorScheme:"primary",type:"submit",isLoading:t||c,isDisabled:t||c,"data-testid":"create-dataset-btn",children:"Generate dataset"})})]}),(0,r.jsx)(p.Z,{title:"Generate and classify this dataset",message:"You have chosen to generate and classify this dataset. This process may take several minutes. In the meantime you can continue using Fides. You will receive a notification when the process is complete.",isOpen:void 0!==n.classifyConfirmed,onClose:()=>{o({values:{...i,classifyConfirmed:!1}})},onConfirm:()=>{l("classifyConfirmed",!0),setTimeout(()=>{a()},0)}})]})}})},A=n(66527),S=n(65399),L=n(12719),R=n(50558),D=()=>{let[e]=(0,C.IR)(),[t,n]=(0,i.useState)(!0),[a,o]=(0,i.useState)(!1),[l,c]=(0,i.useState)(!1),d=(0,i.useRef)(null),u=(0,f.useRouter)(),h=(0,s.pmc)(),{errorAlert:x}=(0,S.VY)(),[m,p]=(0,i.useState)(void 0),j=e=>{A.ZP.load(e,{json:!0}),p(void 0)},y=async t=>{let n;return"object"==typeof t&&null!=t&&"dataset"in t&&Array.isArray(t.dataset)?[n]=t.dataset:n=t,e(n)},b=e=>{h((0,v.t5)("Successfully loaded new dataset YAML")),(0,C.Zl)(e.fides_key),u.push("/dataset/".concat(e.fides_key))},k=async()=>{o(!0);let e=d.current.getValue(),t=A.ZP.load(e,{json:!0}),n=await y(t);(0,g.D4)(n)?h((0,v.Vo)((0,g.e$)(n.error))):"data"in n&&b(n.data),o(!1)};return(0,r.jsxs)(s.kCb,{gap:"97px",children:[(0,r.jsxs)(s.xuv,{w:"75%",children:[(0,r.jsx)(s.xuv,{color:"gray.700",fontSize:"14px",mb:4,children:"Get started creating your first dataset by pasting your dataset yaml below! You may have received this yaml from a colleague or your Ethyca developer support engineer."}),(0,r.jsxs)(s.gCW,{align:"stretch",children:[(0,r.jsx)(s.izJ,{color:"gray.100"}),(0,r.jsx)(L.M,{defaultLanguage:"yaml",height:"calc(100vh - 515px)",onChange:e=>{try{c(!0),j(e),n(!!(!e||""===e.trim()))}catch(e){(0,L.F)(e)?p(e):x("Could not parse the supplied YAML")}},onMount:e=>{d.current=e,d.current.focus()},options:{fontFamily:"Menlo",fontSize:13,minimap:{enabled:!0}},theme:"light"}),(0,r.jsx)(s.izJ,{color:"gray.100"}),(0,r.jsx)(s.hE2,{mt:"24px !important",size:"sm",spacing:"8px",variant:"outline",children:(0,r.jsx)(s.zxk,{bg:"primary.800",color:"white",isDisabled:t||!!m||a,isLoading:a,loadingText:"Saving Yaml system",onClick:k,size:"sm",variant:"solid",type:"submit",_active:{bg:"primary.500"},_hover:{bg:"primary.400"},children:"Create dataset"})})]})]}),(0,r.jsx)(s.xuv,{children:l&&(t||m)&&(0,r.jsx)(R.Z,{isEmptyState:t,yamlError:m})})]})},E=()=>{let e=(0,a.hz)(),[t,n]=(0,i.useState)(null);return(0,r.jsxs)(o.Z,{title:"Create New Dataset",children:[(0,r.jsx)(l.Z,{backPath:c.$m}),(0,r.jsx)(s.X6q,{mb:8,fontSize:"2xl",fontWeight:"semibold",children:"Create New Dataset"}),(0,r.jsxs)(s.Kqy,{spacing:8,children:[(0,r.jsxs)(s.xuv,{children:[(0,r.jsx)(s.zxk,{size:"sm",mr:2,variant:"outline",onClick:()=>n("yaml"),isActive:"yaml"===t,"data-testid":"upload-yaml-btn",children:"Upload a Dataset YAML"}),(0,r.jsx)(s.zxk,{size:"sm",mr:2,variant:"outline",onClick:()=>n("database"),isActive:"database"===t,isDisabled:e.flags.dataDiscoveryAndDetection,"data-testid":"connect-db-btn",children:"Connect to a database"}),e.flags.dataDiscoveryAndDetection?(0,r.jsx)(d.Z,{label:"Creating a dataset via a database connection is disabled when the 'detection & discovery' beta feature is enabled"}):null]}),"database"===t&&(0,r.jsx)(s.xuv,{w:{base:"100%",lg:"50%"},children:(0,r.jsx)(_,{})}),"yaml"===t&&(0,r.jsx)(s.xuv,{w:{base:"100%"},children:(0,r.jsx)(D,{})})]})]})}},41164:function(e,t,n){"use strict";n.d(t,{Bw:function(){return a},D4:function(){return s},Dy:function(){return l},XD:function(){return c},cz:function(){return d},hE:function(){return o},oK:function(){return i}});var r=n(76649);let s=e=>"error"in e,i=e=>(0,r.Ln)({status:"string"},e)&&"PARSING_ERROR"===e.status,a=e=>(0,r.Ln)({status:"number",data:{}},e),o=e=>(0,r.Ln)({detail:"string"},e),l=e=>(0,r.Ln)({detail:{error:"string",resource_type:"string",fides_key:"string"}},e),c=e=>(0,r.Ln)({detail:{error:"string",resource_type:"string",fides_key:"string"}},e),d=e=>(0,r.Ln)({detail:[{loc:["string","number"],msg:"string",type:"string"}]},e)}},function(e){e.O(0,[7923,2888,9774,179],function(){return e(e.s=73846)}),_N_E=e.O()}]);