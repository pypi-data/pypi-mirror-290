var M=Object.defineProperty;var S=(s,e,n)=>e in s?M(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n;var g=(s,e,n)=>(S(s,typeof e!="symbol"?e+"":e,n),n);import{_ as U}from"./DocsButton.vue_vue_type_script_setup_true_lang.05d4ef76.js";import{_ as A,F as E}from"./AbstraButton.vue_vue_type_script_setup_true_lang.b471ceaa.js";import{d as j,B as V,f as w,o as l,W as u,Z as T,R as _,e5 as B,a as m,e as z,cE as k,c as v,w as a,b as i,u as t,d9 as h,d4 as I,ax as f,e6 as N,e7 as L,aJ as b,d5 as $,d3 as P,e9 as Z,bD as q}from"./vue-router.97d0d8a6.js";import{C as y}from"./gateway.91a35dd3.js";import{A as O}from"./Avatar.ea229645.js";import{C as F}from"./Card.d83ffd8b.js";import{A as R}from"./index.557e8025.js";import{A as W}from"./index.4c3aef8d.js";import"./BookOutlined.868baafb.js";import"./popupNotifcation.80047f06.js";import"./TabPane.1a05f343.js";import"./isNumeric.75337b1e.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[e]="a5e01865-de81-4cd1-acbb-0c8fe12ef1c7",s._sentryDebugIdIdentifier="sentry-dbid-a5e01865-de81-4cd1-acbb-0c8fe12ef1c7")}catch{}})();const G=["width","height","fill","transform"],J={key:0},Y=m("path",{d:"M208,28H48A20,20,0,0,0,28,48V208a20,20,0,0,0,20,20H208a20,20,0,0,0,20-20V48A20,20,0,0,0,208,28Zm-4,176H52V52H204ZM76,128a12,12,0,0,1,12-12h28V88a12,12,0,0,1,24,0v28h28a12,12,0,0,1,0,24H140v28a12,12,0,0,1-24,0V140H88A12,12,0,0,1,76,128Z"},null,-1),K=[Y],Q={key:1},X=m("path",{d:"M216,48V208a8,8,0,0,1-8,8H48a8,8,0,0,1-8-8V48a8,8,0,0,1,8-8H208A8,8,0,0,1,216,48Z",opacity:"0.2"},null,-1),ee=m("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32Zm0,176H48V48H208V208Zm-32-80a8,8,0,0,1-8,8H136v32a8,8,0,0,1-16,0V136H88a8,8,0,0,1,0-16h32V88a8,8,0,0,1,16,0v32h32A8,8,0,0,1,176,128Z"},null,-1),te=[X,ee],ne={key:2},oe=m("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM168,136H136v32a8,8,0,0,1-16,0V136H88a8,8,0,0,1,0-16h32V88a8,8,0,0,1,16,0v32h32a8,8,0,0,1,0,16Z"},null,-1),ae=[oe],ie={key:3},re=m("path",{d:"M208,34H48A14,14,0,0,0,34,48V208a14,14,0,0,0,14,14H208a14,14,0,0,0,14-14V48A14,14,0,0,0,208,34Zm2,174a2,2,0,0,1-2,2H48a2,2,0,0,1-2-2V48a2,2,0,0,1,2-2H208a2,2,0,0,1,2,2Zm-36-80a6,6,0,0,1-6,6H134v34a6,6,0,0,1-12,0V134H88a6,6,0,0,1,0-12h34V88a6,6,0,0,1,12,0v34h34A6,6,0,0,1,174,128Z"},null,-1),se=[re],le={key:4},ce=m("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32Zm0,176H48V48H208V208Zm-32-80a8,8,0,0,1-8,8H136v32a8,8,0,0,1-16,0V136H88a8,8,0,0,1,0-16h32V88a8,8,0,0,1,16,0v32h32A8,8,0,0,1,176,128Z"},null,-1),de=[ce],ue={key:5},pe=m("path",{d:"M208,36H48A12,12,0,0,0,36,48V208a12,12,0,0,0,12,12H208a12,12,0,0,0,12-12V48A12,12,0,0,0,208,36Zm4,172a4,4,0,0,1-4,4H48a4,4,0,0,1-4-4V48a4,4,0,0,1,4-4H208a4,4,0,0,1,4,4Zm-40-80a4,4,0,0,1-4,4H132v36a4,4,0,0,1-8,0V132H88a4,4,0,0,1,0-8h36V88a4,4,0,0,1,8,0v36h36A4,4,0,0,1,172,128Z"},null,-1),he=[pe],ge={name:"PhPlusSquare"},fe=j({...ge,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(s){const e=s,n=V("weight","regular"),o=V("size","1em"),C=V("color","currentColor"),c=V("mirrored",!1),p=w(()=>{var d;return(d=e.weight)!=null?d:n}),r=w(()=>{var d;return(d=e.size)!=null?d:o}),H=w(()=>{var d;return(d=e.color)!=null?d:C}),x=w(()=>e.mirrored!==void 0?e.mirrored?"scale(-1, 1)":void 0:c?"scale(-1, 1)":void 0);return(d,ve)=>(l(),u("svg",B({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:r.value,height:r.value,fill:H.value,transform:x.value},d.$attrs),[T(d.$slots,"default"),p.value==="bold"?(l(),u("g",J,K)):p.value==="duotone"?(l(),u("g",Q,te)):p.value==="fill"?(l(),u("g",ne,ae)):p.value==="light"?(l(),u("g",ie,se)):p.value==="regular"?(l(),u("g",le,de)):p.value==="thin"?(l(),u("g",ue,he)):_("",!0)],16,G))}});class me{async getLoginUrl(e,n,o){return y.get(`projects/${e}/connectors/${o}/connections/${n}/login-url`)}async listConnectors(e){return y.get(`projects/${e}/connectors`)}async listConnections(e){return y.get(`projects/${e}/connections`)}async deleteConnection(e){const{projectId:n,connectionName:o,connectorType:C}=e;return y.delete(`projects/${n}/connectors/${C}/connections/${o}`)}async renameConnection(e){const{projectId:n,connectionName:o,connectorType:C,newConnectionName:c}=e;return y.patch(`projects/${n}/connectors/${C}/connections/${o}`,{newConnectionName:c})}}class Ce{constructor(e,n){g(this,"state");g(this,"hasChanges",w(()=>!!this.state.value.editingConnection&&this.state.value.editingConnection.name!==this.state.value.editingConnection.newName));g(this,"handleDeletionClick",async()=>{if(!this.state.value.editingConnection)throw new Error("No connection is being edited");k.confirm({title:"Delete connection",content:"Are you sure you want to delete this connection?",onOk:this.handleDeleteConnection})});g(this,"handleDeleteConnection",async()=>{if(!this.state.value.editingConnection)throw new Error("No connection is being edited");await this.api.deleteConnection({projectId:this.projectId,connectionName:this.state.value.editingConnection.name,connectorType:this.state.value.editingConnection.connectorType}),this.state.value.editingConnection=null,await this.refetchConnections()});g(this,"handleAddConnectionSubmit",async e=>{const{url:n}=await this.getLoginUrl(e,this.getUniqueName(e));window.location.href=n});g(this,"renameConnection",async()=>{const{editingConnection:e}=this.state.value;if(!e)throw new Error("No connection is being edited");const n=async()=>{await this.api.renameConnection({projectId:this.projectId,connectionName:e.name,connectorType:e.connectorType,newConnectionName:e.newName}),await this.refetchConnections(),this.state.value.editingConnection=null};k.confirm({title:"Rename connection",content:"Are you sure you want to rename this connection? This will break any existing references to the old name.",onOk:n})});g(this,"showAddConfirmationModal",e=>{k.confirm({title:"Add connection",content:"You are about to be redirected to the external service to authorize the connection.",icon:null,onOk:()=>this.handleAddConnectionSubmit(e.type)})});this.projectId=e,this.api=n,this.state=z({connectors:[],connections:[],editingConnection:null,showCreateModal:!1})}async fetchConnectors(){this.state.value.connectors=await this.api.listConnectors(this.projectId)}async fetchInitialState(){await this.fetchConnectors(),await this.refetchConnections()}async refetchConnections(){this.state.value.connections=(await this.api.listConnections(this.projectId)).map(e=>{const n=this.state.value.connectors.find(o=>o.type===e.connectorType);if(!n)throw new Error(`Unknown connector type: ${e.connectorType}`);return{name:e.name,connectorTitle:n.title,connectorType:e.connectorType,icon:n.logoUrl}})}handleEditConnectionClick(e){this.state.value.editingConnection={...e,newName:e.name}}async getLoginUrl(e,n){return this.api.getLoginUrl(this.projectId,n,e)}slugify(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-")}getUniqueName(e){const n=this.state.value.connections.filter(o=>o.connectorType===e).length;return n===0?e:`${e}-${n}`}}const D=j({__name:"ConnectorCard",props:{title:{},logoUrl:{},description:{}},setup(s){return(e,n)=>(l(),v(t(F),{style:{width:"300px"}},{default:a(()=>[i(t(h),{style:{width:"100%"},vertical:"",gap:12},{default:a(()=>[i(t(h),{justify:"space-between"},{default:a(()=>[i(t(O),{src:e.logoUrl,shape:"square",size:"large"},null,8,["src"]),T(e.$slots,"default",{style:"align-self: flex-start"})]),_:3}),i(t(h),{vertical:""},{default:a(()=>[i(t(I),{strong:""},{default:a(()=>[f(N(e.title),1)]),_:1}),i(t(I),{type:"secondary"},{default:a(()=>[f(N(e.description),1)]),_:1})]),_:1})]),_:3})]),_:3}))}}),De=j({__name:"ConnectorsView",setup(s){const n=L().params.projectId,o=new Ce(n,new me);return o.fetchInitialState(),(C,c)=>{var p;return l(),u(b,null,[i(t(R),{direction:"vertical",style:{width:"100%","margin-bottom":"30px"}},{default:a(()=>[i(t(h),{align:"center",justify:"space-between"},{default:a(()=>[i(t($),null,{default:a(()=>[f("Connectors")]),_:1})]),_:1}),i(t(P),null,{default:a(()=>[f(" Add and manage external integrations to your project. "),i(U)]),_:1}),t(o).state.value.connections.length?(l(),v(t(h),{key:0,vertical:""},{default:a(()=>[i(t($),{level:2},{default:a(()=>[f("Active")]),_:1}),i(t(h),{gap:"10"},{default:a(()=>[(l(!0),u(b,null,Z(t(o).state.value.connections,r=>(l(),v(D,{key:r.name,title:r.connectorTitle,"logo-url":r.icon,description:r.name},{default:a(()=>[i(A,{onClick:H=>t(o).handleEditConnectionClick(r)},{default:a(()=>[i(t(E))]),_:2},1032,["onClick"])]),_:2},1032,["title","logo-url","description"]))),128))]),_:1})]),_:1})):_("",!0),i(t(h),{vertical:""},{default:a(()=>[t(o).state.value.connections.length?(l(),v(t($),{key:0,level:2},{default:a(()=>[f("Available")]),_:1})):_("",!0),i(t(h),{gap:"10",wrap:"wrap"},{default:a(()=>[(l(!0),u(b,null,Z(t(o).state.value.connectors,r=>(l(),v(D,{key:r.type,title:r.title,"logo-url":r.logoUrl,description:r.description},{default:a(()=>[i(A,{onClick:H=>t(o).showAddConfirmationModal(r)},{default:a(()=>[i(t(fe))]),_:2},1032,["onClick"])]),_:2},1032,["title","logo-url","description"]))),128))]),_:1})]),_:1})]),_:1}),i(t(W),{open:!!t(o).state.value.editingConnection,title:`${(p=t(o).state.value.editingConnection)==null?void 0:p.connectorTitle} Connection`,onOk:t(o).handleDeletionClick,onClose:c[3]||(c[3]=()=>t(o).state.value.editingConnection=null)},{extra:a(()=>[i(A,{disabled:!t(o).hasChanges.value,onClick:c[0]||(c[0]=r=>t(o).renameConnection())},{default:a(()=>[f(" Save ")]),_:1},8,["disabled"])]),footer:a(()=>[i(t(h),{justify:"end"},{default:a(()=>[i(A,{danger:"",onClick:c[2]||(c[2]=r=>t(o).handleDeletionClick())},{default:a(()=>[f("Delete")]),_:1})]),_:1})]),default:a(()=>[t(o).state.value.editingConnection?(l(),v(t(q),{key:0,value:t(o).state.value.editingConnection.newName,"onUpdate:value":c[1]||(c[1]=r=>t(o).state.value.editingConnection.newName=r)},null,8,["value"])):_("",!0)]),_:1},8,["open","title","onOk"])],64)}}});export{De as default};
//# sourceMappingURL=ConnectorsView.737fd47c.js.map
